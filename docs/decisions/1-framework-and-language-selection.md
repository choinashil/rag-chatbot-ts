# 프레임워크 및 언어 선택

> Express.js + JavaScript 기반에서 Fastify + TypeScript로의 전환 결정과 그 근거를 기록합니다.

## 1. 프레임워크 선택: Express → Fastify

### 배경
기존 Express.js 기반 RAG 챗봇을 프로덕션 레벨로 개선하면서 프레임워크 교체를 검토

### 검토 대상
- **Express** (현재): 기존 코드 유지
- **Fastify**: 성능 중심 경량 프레임워크  
- **NestJS**: Enterprise급 아키텍처 프레임워크

### 의사결정 과정

#### 1차 평가 (일반적 관점)
| 항목 | Express | Fastify | NestJS |
|------|---------|---------|--------|
| **성능** | 기본 | ⭐⭐⭐ (+20%) | ⭐ (느림) |
| **학습곡선** | ⭐⭐⭐ | ⭐⭐⭐ | ⭐ (가파름) |
| **생태계** | ⭐⭐⭐ | ⭐⭐ | ⭐⭐ |
| **메모리** | 보통 | ⭐⭐⭐ | ⭐ (높음) |

#### 2차 평가 (GraphQL 클라이언트 요구사항 반영)
- **요구사항**: 외부 Apollo GraphQL 서버와 통신 필요
- **역할**: GraphQL 클라이언트만 사용 (서버 구축 아님)

**결론**: GraphQL 클라이언트 사용은 프레임워크 무관 (동일한 `graphql-request` 라이브러리 사용)

#### 3차 평가 (RAG 서비스 특성 고려)

**RAG 챗봇 서비스의 특성:**
- 벡터 검색 + LLM 호출로 인한 높은 응답 지연
- 문서 임베딩으로 인한 높은 메모리 사용량
- 실시간 스트리밍 응답 필요
- 동시 사용자 처리 성능 중요

**RAG 관점에서의 우선순위:**
1. **응답 속도** (⭐⭐⭐): 서버 오버헤드 최소화 필요
2. **메모리 효율성** (⭐⭐⭐): 벡터DB와 리소스 경합 최소화
3. **스트리밍 지원** (⭐⭐): LLM 실시간 응답
4. **확장성** (⭐⭐): 수평 확장 대응

### 최종 결정: **Fastify**

**선택 근거:**
- **성능**: Express 대비 20% 향상된 처리 속도
- **메모리**: 낮은 메모리 사용량으로 벡터DB와 리소스 경합 최소화
- **스트리밍**: 내장 스트림 지원으로 LLM 응답 스트리밍 최적화
- **마이그레이션**: Express와 유사한 API로 빠른 전환 가능
- **MVP 적합성**: 복잡한 아키텍처 학습 없이 빠른 개발

**기각된 선택지:**
- **Express**: 성능 개선 효과 없음
- **NestJS**: RAG 서비스 특성상 불필요한 복잡성, 성능 오버헤드

## 2. 언어 선택: JavaScript → TypeScript

### 배경
기존 JavaScript 코드베이스의 타입 안전성 및 개발 경험 개선 필요

### 선택 근거
- **타입 안전성**: 컴파일 타임 에러 검출
- **개발 경험**: IDE 지원, 자동완성, 리팩토링
- **코드 품질**: 명시적 타입으로 코드 가독성 향상
- **GraphQL 연동**: GraphQL 스키마와 TypeScript 타입 연동 가능

### 마이그레이션 전략
1. 단계적 전환 (.js → .ts)
2. 기존 JavaScript 코드와 호환성 유지
3. 점진적 타입 정의 추가

## 3. 아키텍처 개선 우선순위

### MVP 기준 필수 개선사항 (우선순위 순)

1. **TypeScript 전환** (⭐⭐⭐)
   - ROI가 가장 높음
   - 개발 생산성 즉시 향상

2. **에러 핸들링 & 검증** (⭐⭐⭐)
   - 서비스 안정성 직결
   - 사용자 경험 개선

3. **보안 미들웨어** (⭐⭐⭐)
   - 프로덕션 배포 필수
   - Rate limiting, Helmet, Input sanitization

4. **테스트 프레임워크** (⭐⭐⭐)
   - 코드 신뢰성 확보
   - 지속적 개선 기반

5. **로깅 & 모니터링** (⭐⭐)
   - 운영 중 문제 진단
   - 성능 최적화 데이터

## 4. 향후 고려사항

### 확장 시나리오별 재검토 포인트

**팀 규모 확장시:**
- Fastify 아키텍처 가이드라인 수립
- 코드 컨벤션 및 리뷰 프로세스 강화

**기능 복잡도 증가시:**
- 마이크로서비스 아키텍처 고려
- NestJS 재검토 (모듈화, DI 필요시)

**성능 요구사항 변화시:**
- 캐싱 전략 수립
- 로드밸런싱 및 수평 확장

## 의사결정 기준

이 문서의 모든 기술 선택은 다음 기준을 바탕으로 결정되었습니다:

1. **RAG 서비스 특성 최적화**: 응답 속도와 메모리 효율성 우선
2. **MVP 개발 속도**: 빠른 구현과 테스트 가능성
3. **확장 가능성**: 향후 성장에 대한 유연한 대응
4. **팀 학습 곡선**: 기존 지식 활용과 점진적 개선

---

**작성일**: 2025-08-07  
**작성자**: Development Team  
**다음 리뷰**: 프로덕션 배포 후 3개월