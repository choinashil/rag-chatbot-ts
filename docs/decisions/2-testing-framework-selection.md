# 테스팅 프레임워크 선택

> **작성일**: 2025-08-07 11:50  
> **결정 사항**: Jest + Supertest + ts-jest 조합 선택  
> **적용 범위**: 단위 테스트, 통합 테스트, API 테스트

## 배경

1단계 기본 구조 완성 후, 각 기능 개발과 함께 안정적인 검증이 필요함. 헬스체크만으로는 세부 기능 검증에 한계가 있어 체계적인 테스트 프레임워크 도입 필요.

## 검토 대상

### 테스트 프레임워크
- **Jest**: 가장 널리 사용되는 JavaScript/TypeScript 테스트 프레임워크
- **Vitest**: 빠른 실행 속도, ES 모듈 네이티브 지원
- **Mocha + Chai**: 유연한 설정, 다양한 assertion 라이브러리

### HTTP 테스트 라이브러리
- **Supertest**: HTTP 요청 테스트 전용 라이브러리
- **직접 fetch 사용**: 네이티브 API 활용
- **axios**: 일반적인 HTTP 클라이언트

### TypeScript 지원
- **ts-jest**: Jest용 TypeScript 프리프로세서
- **tsx**: 빠른 TypeScript 실행기
- **babel**: 트랜스파일링 도구

## 의사결정 과정

### Jest 선택 근거
| 항목 | Jest | Vitest | Mocha + Chai |
|------|------|---------|--------------|
| **학습 곡선** | ⭐⭐⭐ 쉬움 | ⭐⭐ 보통 | ⭐ 어려움 |
| **TypeScript 지원** | ⭐⭐⭐ 우수 | ⭐⭐⭐ 우수 | ⭐⭐ 보통 |
| **생태계** | ⭐⭐⭐ 방대함 | ⭐⭐ 성장 중 | ⭐⭐ 성숙함 |
| **Fastify 호환성** | ⭐⭐⭐ 완벽 | ⭐⭐ 좋음 | ⭐⭐ 좋음 |
| **모킹 기능** | ⭐⭐⭐ 강력함 | ⭐⭐ 보통 | ⭐ 수동 설정 |

### Supertest 선택 근거
**장점:**
- **Fastify와 완벽 호환**: Node.js 서버 프레임워크 범용 지원
- **실제 HTTP 요청**: 실제 서버와 동일한 환경에서 테스트
- **간단한 문법**: `.get()`, `.post()`, `.expect()` 체이닝으로 직관적
- **Jest 자연스러운 연동**: 별도 설정 거의 불필요

**기각된 대안:**
- **직접 fetch**: 더 복잡한 설정, 에러 처리 번거로움
- **axios**: HTTP 클라이언트로는 우수하지만 테스트 전용 기능 부족

### ts-jest 선택 근거
- **완벽한 TypeScript 지원**: 타입 검사 + 테스트 실행
- **Jest 생태계**: Jest의 모든 기능과 호환
- **설정 간소화**: 최소 설정으로 TypeScript 테스트 가능

## 최종 결정: Jest + Supertest + ts-jest

### 선택된 스택
```json
{
  "devDependencies": {
    "jest": "^29.7.0",
    "supertest": "^7.0.0",
    "@types/jest": "^29.5.12",
    "@types/supertest": "^6.0.2",
    "ts-jest": "^29.2.5"
  }
}
```

### 테스트 유형별 적용
- **단위 테스트**: Jest + 모킹으로 개별 함수/클래스 테스트
- **통합 테스트**: Jest + 실제 서비스 연동으로 전체 플로우 테스트  
- **API 테스트**: Supertest로 HTTP 엔드포인트 테스트

### 기대 효과
1. **개발 안정성**: 각 기능 개발 후 즉시 검증 가능
2. **환경 독립성**: 모킹으로 외부 의존성 없이 테스트 가능
3. **회귀 방지**: 기존 기능 변경 시 사이드이펙트 조기 발견
4. **문서화 효과**: 테스트 코드가 사용법 예시 역할

## 테스트 관리 전략

### 테스트 라이프사이클
1. **기능 개발** → 테스트 작성
2. **기능 변경** → 테스트 수정
3. **기능 삭제** → 테스트 삭제
4. **리팩토링** → 테스트 유지 (인터페이스 동일시)

### 검증 방식
- **모킹 방식**: 단위 테스트, 환경 독립적 검증
- **실제 HTTP 요청**: 통합 테스트, 실제 환경 검증
- **헬스체크**: 운영 중 서비스 상태 모니터링

## 향후 고려사항

1. **E2E 테스트**: Playwright 등 브라우저 테스트 도구 검토 (FE 추가 후)
2. **성능 테스트**: Artillery 등 부하 테스트 도구 검토
3. **테스트 커버리지**: 80% 이상 유지 목표

---

**최종 수정일**: 2025-08-07 11:50  
**다음 리뷰 예정**: 테스트 코드 작성 완료 후