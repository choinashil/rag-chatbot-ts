# 단순 HTML 텍스트 추출 방식 - 최종 채택 방안

> **작성일**: 2025-08-09 22:00 KST  
> **대상**: Sixshop Pro 가이드 문서 HTML 단순 텍스트 추출  
> **목적**: 벡터화를 위한 최적화된 텍스트 추출 방식 확정  
> **상태**: ✅ **최종 채택 및 구현 완료**

## 개요

복잡한 의미론적 청킹 방식을 포기하고, **단순한 전체 페이지 텍스트 추출** 방식을 최종 채택했습니다. 이는 노션 API 방식과 복잡한 HTML 파싱 방식을 모두 테스트한 결과, 실용성과 효율성 측면에서 가장 우수한 방식으로 판단되었습니다.

## 방식 비교 테스트 결과

### 1. **노션 API 방식** (채택되지 않음)
**장점:**
- 사용자가 노션에 작성했을 때의 표현 의도를 디테일하게 파악 가능
- 어떤 종류의 블록을 사용했는지 정확히 알 수 있음
- 구조화된 데이터로 세밀한 처리 가능

**단점:**
- `column_list` 등 하위 블록을 가질 수 있는 블록에서 재귀적 추가 호출 필요
- 다양한 블록 종류에 따라 각각 다른 처리 로직 필요 (복잡도 증가)
- 내부 URL로 인한 사용자 접근성 제한
- API 호출 비용 및 속도 이슈

### 2. **복잡한 HTML 파싱 방식** (채택되지 않음)  
**장점:**
- 의미론적 구조 보존
- 계층적 청킹을 통한 컨텍스트 관리

**단점:**
- 개발 복잡도 과도함 (실제 이익 대비)
- 메모리 사용량 증가
- oopy 특성상 하위 페이지 내용이 혼재되어 부정확성 발생
- 과도한 엔지니어링으로 인한 유지보수 부담

### 3. **단순 HTML 텍스트 추출 방식** ✅ **최종 채택**
**장점:**
- 한 번에 전체 HTML을 불러올 수 있어 요청 성능 최적화
- 단순하고 안정적인 구조로 유지보수 용이
- 벡터 검색에 최적화된 순수 텍스트 제공
- 메모리 효율적이고 처리 속도 빠름

**단점:**
- 노션 작성자의 의도 파악 어려움 (블록 종류별 처리 불가)
- SSR 된 내용만 참조 가능 (CSR UI는 누락)
- oopy에서 하위 페이지 내용이 일부 포함되어 약간의 부정확성 존재

**채택 이유:**
- **실용성 우선**: 벡터 검색에서는 의미적 내용이 구조보다 중요
- **성능 최적화**: 단순한 구조로 빠른 처리 및 낮은 자원 사용
- **업계 표준 부합**: OpenAI, Pinecone 등에서 권장하는 순수 텍스트 방식

## 최종 아키텍처

### **데이터 구조**
```typescript
interface VectorDocument {
  content: string           // 순수 텍스트 (Search 이후 부분)
  metadata: {
    url: string,
    title: string,
    breadcrumb: string[]    // 계층 정보
  }
}
```

### **처리 플로우**
```
1. axios → HTML 수집
2. cheerio → DOM 파싱 및 불필요 요소 제거
3. .text() → 순수 텍스트 추출  
4. 'Search' 기준 분할 → breadcrumb 분리 (oopy 페이지의 '검색' 키워드 기준으로 분리)
5. 벡터 DB 저장
```

### **핵심 기술 결정**
- **텍스트 저장**: 순수 텍스트만 저장 (마크다운 링크 제거)
- **breadcrumb**: 메타데이터로 별도 관리 (검색 품질 향상)
- **분할 방식**: `split('Search')` 사용 (유지보수성)
- **라이브러리**: axios + cheerio 조합 (업계 표준)

## 구현 완료 현황

### ✅ 구현 완료 항목
- [x] 단순 HTML 텍스트 추출 스크립트 (`simple-html-parser.ts`)
- [x] axios + cheerio 기반 안정적 HTML 수집
- [x] Search 기준 breadcrumb 분리
- [x] 순수 텍스트 벡터 저장 방식
- [x] 두 테스트 페이지 검증 완료

### **테스트 결과**
```
웹사이트 디자인 페이지: 793자 순수 텍스트
웹사이트 디자인 입문하기: 2,092자 순수 텍스트
breadcrumb: 100% 정확한 계층 구조 추출
성능: 메모리 효율적, 빠른 처리 속도
```

## 다음 단계 계획

### **3단계: 다중 페이지 수집 시스템** (예정)
- 재귀적 사이트 크롤링
- 페이지 간 관계 매핑
- 중복 제거 및 우선순위 관리

### **4단계: 벡터 데이터베이스 연동** (예정)
- Pinecone 연동 및 메타데이터 최적화
- 배치 처리 시스템
- 검색 품질 측정

## 교훈 및 인사이트

### **개발 접근법**
- **MVP 우선**: 복잡한 설계보다 동작하는 단순한 솔루션이 우선
- **실용성 중심**: 이론적 완벽함보다 실제 사용성과 유지보수성 고려
- **점진적 개선**: 기본 동작 확보 후 필요 시에만 복잡도 추가

### **기술 선택 기준**
- **업계 표준 준수**: 검증된 방식 우선 채택
- **성능과 단순성**: 과도한 엔지니어링 지양
- **확장 가능성**: 향후 개선이 용이한 구조

---

**현재 상태**: ✅ 최종 방식 확정 및 구현 완료  
**다음 작업**: 3단계 다중 페이지 수집 시스템 구축  
**최종 수정일**: 2025-08-09 22:00 KST  
**책임자**: Development Team